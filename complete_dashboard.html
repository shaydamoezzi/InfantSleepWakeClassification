<!DOCTYPE html>
<html>
<head>
    <title>Infant Arousal Annotation Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .video-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #444;
            margin-top: 0;
        }
        .metrics-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .metric-title {
            font-weight: bold;
            color: #555;
            margin-bottom: 10px;
        }
        .kappa-value {
            font-size: 24px;
            color: #2196F3;
            text-align: center;
            margin: 10px 0;
        }
        .kappa-label {
            color: #666;
            font-size: 0.9em;
            text-align: center;
        }
        .kappa-matrix {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .kappa-matrix th, .kappa-matrix td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .kappa-matrix th {
            background: #f5f5f5;
        }
        .annotator-select {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .annotator-select select {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .comparison-result {
            text-align: center;
            padding: 10px;
            font-size: 1.1em;
            color: #444;
        }
    </style>
</head>
<body>
    <h1>Infant Arousal Annotation Dashboard</h1>
    
    <!-- Video Card Template -->
    <template id="video-card-template">
        <div class="video-card">
            <h2>Video {VIDEO_ID}</h2>
            <div id="plot-{VIDEO_ID}"></div>
            <div class="metrics-section" id="metrics-{VIDEO_ID}">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-title">Fleiss Kappa Score</div>
                        <div class="kappa-value">{FLEISS_KAPPA}</div>
                        <div class="kappa-label">Overall agreement between all annotators</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-title">Pairwise Agreement Matrix</div>
                        <div id="kappa-matrix-{VIDEO_ID}"></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-title">Compare Annotators</div>
                        <div class="annotator-select">
                            <select id="annotator1-{VIDEO_ID}" onchange="updateComparisonResult('{VIDEO_ID}')">
                                <option value="">Select Annotator 1</option>
                                {ANNOTATOR_OPTIONS}
                            </select>
                            <select id="annotator2-{VIDEO_ID}" onchange="updateComparisonResult('{VIDEO_ID}')">
                                <option value="">Select Annotator 2</option>
                                {ANNOTATOR_OPTIONS}
                            </select>
                        </div>
                        <div id="comparison-result-{VIDEO_ID}" class="comparison-result"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <div id="video-cards"></div>

    <script>
        // Agreement metrics data
        const agreementMetrics = {
            "1": {
                fleissKappa: 0.411,
                annotators: ["Alexys", "Justin", "Liyang", "Emma"],
                pairwiseKappa: {
                    "Justin-Emma": 0.419,
                    "Justin-Liyang": 0.087,
                    "Justin-Alexys": 0.723,
                    "Emma-Liyang": 0.148,
                    "Emma-Alexys": 0.542,
                    "Liyang-Alexys": 0.112
                }
            },
            "2": {
                fleissKappa: 0.722,
                annotators: ["Liyang", "Emma", "Yasmin"],
                pairwiseKappa: {
                    "Liyang-Emma": 0.669,
                    "Liyang-Yasmin": 0.907,
                    "Emma-Yasmin": 0.649
                }
            },
            "3": {
                fleissKappa: 0.552,
                annotators: ["Liyang", "Yasmin", "Marina", "Justin", "Emma"],
                pairwiseKappa: {
                    "Liyang-Marina": 0.434,
                    "Liyang-Yasmin": 0.555,
                    "Liyang-Emma": 0.627,
                    "Liyang-Justin": 0.439,
                    "Marina-Yasmin": 0.404,
                    "Marina-Emma": 0.47,
                    "Marina-Justin": 0.362,
                    "Yasmin-Emma": 0.681,
                    "Yasmin-Justin": 0.729,
                    "Emma-Justin": 0.688
                }
            },
            "6": {
                fleissKappa: 0.319,
                annotators: ["Justin", "Emma"],
                pairwiseKappa: {
                    "Justin-Emma": 0.32
                }
            },
            "7": {
                fleissKappa: 0.725,
                annotators: ["Justin", "Liyang", "Emma", "Yasmin"],
                pairwiseKappa: {
                    "Emma-Liyang": 0.749,
                    "Emma-Yasmin": 0.812,
                    "Emma-Justin": 0.753,
                    "Liyang-Yasmin": 0.823,
                    "Liyang-Justin": 0.609,
                    "Yasmin-Justin": 0.663
                }
            },
            "9": {
                fleissKappa: 0.727,
                annotators: ["Justin", "Liyang", "Yasmin", "Emma"],
                pairwiseKappa: {
                    "Liyang-Yasmin": 0.954,
                    "Liyang-Emma": 0.598,
                    "Liyang-Justin": 0.72,
                    "Yasmin-Emma": 0.637,
                    "Yasmin-Justin": 0.732,
                    "Emma-Justin": 0.692
                }
            },
            "10": {
                fleissKappa: 0.394,
                annotators: ["Sam", "Liyang", "Yasmin", "Justin", "Emma"],
                pairwiseKappa: {
                    "Emma-Sam": 0.476,
                    "Emma-Liyang": 0.119,
                    "Emma-Yasmin": 0.456,
                    "Emma-Justin": 0.392,
                    "Sam-Liyang": 0.074,
                    "Sam-Yasmin": 0.446,
                    "Sam-Justin": 0.727,
                    "Liyang-Yasmin": 0.517,
                    "Liyang-Justin": 0.058,
                    "Yasmin-Justin": 0.378
                }
            },
            "11": {
                fleissKappa: 0.903,
                annotators: ["Justin", "Emma"],
                pairwiseKappa: {
                    "Justin-Emma": 0.904
                }
            },
            "12": {
                fleissKappa: 0.747,
                annotators: ["Justin", "Liyang", "Yasmin", "Emma"],
                pairwiseKappa: {
                    "Liyang-Yasmin": 0.737,
                    "Liyang-Justin": 0.545,
                    "Liyang-Emma": 0.632,
                    "Yasmin-Justin": 0.775,
                    "Yasmin-Emma": 0.849,
                    "Justin-Emma": 0.88
                }
            },
            "13": {
                fleissKappa: 0.582,
                annotators: ["Justin", "Emma"],
                pairwiseKappa: {
                    "Emma-Justin": 0.587
                }
            },
            "14": {
                fleissKappa: 0.627,
                annotators: ["Justin", "Liyang", "Emma", "Yasmin"],
                pairwiseKappa: {
                    "Emma-Justin": 0.545,
                    "Emma-Liyang": 0.617,
                    "Emma-Yasmin": 0.643,
                    "Justin-Liyang": 0.566,
                    "Justin-Yasmin": 0.599,
                    "Liyang-Yasmin": 0.913
                }
            },
            "15": {
                fleissKappa: 0.673,
                annotators: ["Justin", "Yasmin", "Emma"],
                pairwiseKappa: {
                    "Justin-Emma": 0.806,
                    "Justin-Yasmin": 0.522,
                    "Emma-Yasmin": 0.657
                }
            },
            "16": {
                fleissKappa: 0.58,
                annotators: ["Sam", "Liyang", "Yasmin", "Justin", "Emma"],
                pairwiseKappa: {
                    "Emma-Justin": 0.102,
                    "Emma-Liyang": 0.75,
                    "Emma-Sam": 0.812,
                    "Emma-Yasmin": 0.81,
                    "Justin-Liyang": 0.069,
                    "Justin-Sam": 0.113,
                    "Justin-Yasmin": 0.086,
                    "Liyang-Sam": 0.649,
                    "Liyang-Yasmin": 0.903,
                    "Sam-Yasmin": 0.698
                }
            },
            "18": {
                fleissKappa: 0.472,
                annotators: ["Alexys", "Justin", "Liyang", "Yasmin"],
                pairwiseKappa: {
                    "Liyang-Yasmin": 0.899,
                    "Liyang-Alexys": 0.24,
                    "Liyang-Justin": 0.288,
                    "Yasmin-Alexys": 0.296,
                    "Yasmin-Justin": 0.346,
                    "Alexys-Justin": 0.772
                }
            },
            "19": {
                fleissKappa: 0.51,
                annotators: ["Justin", "Yasmin", "Liyang", "Emma"],
                pairwiseKappa: {
                    "Emma-Justin": 0.877,
                    "Emma-Yasmin": 0.399,
                    "Emma-Liyang": 0.336,
                    "Justin-Yasmin": 0.328,
                    "Justin-Liyang": 0.273,
                    "Yasmin-Liyang": 0.872
                }
            },
            "20": {
                fleissKappa: 0.023,
                annotators: ["Justin", "Liyang", "Emma"],
                pairwiseKappa: {
                    "Liyang-Emma": 0.0,
                    "Liyang-Justin": -0.001,
                    "Emma-Justin": 0.058
                }
            },
            "23": {
                fleissKappa: 0.31,
                annotators: ["Justin", "Liyang", "Yasmin", "Emma"],
                pairwiseKappa: {
                    "Liyang-Yasmin": 0.777,
                    "Liyang-Emma": 0.517,
                    "Liyang-Justin": 0.013,
                    "Yasmin-Emma": 0.521,
                    "Yasmin-Justin": 0.165,
                    "Emma-Justin": -0.048
                }
            },
            "24": {
                fleissKappa: 0.689,
                annotators: ["Justin", "Yasmin", "Liyang", "Emma"],
                pairwiseKappa: {
                    "Emma-Justin": 0.908,
                    "Emma-Yasmin": 0.773,
                    "Emma-Liyang": 0.476,
                    "Justin-Yasmin": 0.735,
                    "Justin-Liyang": 0.444,
                    "Yasmin-Liyang": 0.658
                }
            }
        };

        // Function to create annotator options HTML
        function createAnnotatorOptions(annotators) {
            return annotators.map(a => `<option value="${a}">${a}</option>`).join('');
        }

        // Function to create a video card
        function createVideoCard(videoId, metrics) {
            const template = document.getElementById('video-card-template').innerHTML;
            const annotatorOptions = createAnnotatorOptions(metrics.annotators);
            
            return template
                .replace(/{VIDEO_ID}/g, videoId)
                .replace('{FLEISS_KAPPA}', metrics.fleissKappa.toFixed(3))
                .replace(/{ANNOTATOR_OPTIONS}/g, annotatorOptions);
        }

        // Function to update comparison result
        function updateComparisonResult(videoId) {
            const annotator1 = document.getElementById(`annotator1-${videoId}`).value;
            const annotator2 = document.getElementById(`annotator2-${videoId}`).value;
            
            if (annotator1 && annotator2 && annotator1 !== annotator2) {
                const pair = [annotator1, annotator2].sort().join('-');
                const kappa = agreementMetrics[videoId].pairwiseKappa[pair];
                document.getElementById(`comparison-result-${videoId}`).innerHTML = 
                    `Kappa Score between ${annotator1} and ${annotator2}: <strong>${kappa.toFixed(3)}</strong>`;
            } else {
                document.getElementById(`comparison-result-${videoId}`).innerHTML = 
                    'Please select two different annotators';
            }
        }

        // Function to create kappa matrix
        function createKappaMatrix(videoId, container) {
            const metrics = agreementMetrics[videoId];
            const annotators = metrics.annotators;
            
            let table = '<table class="kappa-matrix"><tr><th></th>';
            annotators.forEach(a => {
                table += `<th>${a}</th>`;
            });
            table += '</tr>';
            
            annotators.forEach(a1 => {
                table += `<tr><th>${a1}</th>`;
                annotators.forEach(a2 => {
                    if (a1 === a2) {
                        table += '<td>1.000</td>';
                    } else {
                        const pair = [a1, a2].sort().join('-');
                        const kappa = metrics.pairwiseKappa[pair];
                        table += `<td>${kappa.toFixed(3)}</td>`;
                    }
                });
                table += '</tr>';
            });
            table += '</table>';
            
            container.innerHTML = table;
        }

        // Initialize video cards when page loads
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('video-cards');
            Object.entries(agreementMetrics).forEach(([videoId, metrics]) => {
                const cardHtml = createVideoCard(videoId, metrics);
                container.insertAdjacentHTML('beforeend', cardHtml);
                
                // Create kappa matrix for this video
                const matrixContainer = document.getElementById(`kappa-matrix-${videoId}`);
                if (matrixContainer) {
                    createKappaMatrix(videoId, matrixContainer);
                }
            });
        });
    </script>
</body>
</html> 